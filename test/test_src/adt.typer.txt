enum IntList = Var(Enum IntList { Nil(), Cons(Int, Var(~0)) })
let rec int_array_to_list: (arr: Array[Int], len: Int) -> IntList {
  let rec aux: (i: Int) -> IntList {
    if (Eq(Var("i"), Var("len"))) then {
      CtorApp(Nil, [])
    } else {
      CtorApp(Cons, [Get(Var("arr"), Var("i")), App(Var("aux"), [Prim(Var("i"), Int(1), Add, kind=Some(Int))]), ])
    }
  }
  Apply(Var("aux"), [Int(0), ])
}
let rec print_int_list: (lst: IntList) -> Unit {
  Match(Var("lst"), [
    CtorApp("Nil", []) =>
      Unit
    CtorApp("Cons", [Var("h"), Var("t")]) =>
      let _: Var(Unit) = Apply(Var("print_int"), [Var("h"), ])
      Apply(Var("print_int_list"), [Var("t"), ])
  ])
}
let rec main: () -> Var(Unit) {
  let arr: Var(Array[Int]) = Array::make(Int(5), Int(1))
  let _: Var(Unit) = Put Var("arr")[Int(0)] = Int(1)
  let _: Var(Unit) = Put Var("arr")[Int(1)] = Int(2)
  let _: Var(Unit) = Put Var("arr")[Int(2)] = Int(3)
  let _: Var(Unit) = Put Var("arr")[Int(3)] = Int(4)
  let _: Var(Unit) = Put Var("arr")[Int(4)] = Int(5)
  let lst: Var(Enum IntList { Nil(), Cons(Int, Var(~0)) }) = Apply(Var("int_array_to_list"), [Var("arr"), Int(5), ])
  Apply(Var("print_int_list"), [Var("lst"), ])
}
Unit
